# vMix Controller

vMixを制御するためのPythonアプリケーションです。指定したディレクトリを監視し、最新のファイルを自動的にvMixのOA（オーバーレイ4）にスタンバイします。

## 機能

- **ディレクトリ監視**: 指定したディレクトリを監視し、新しいファイルや更新されたファイルを自動検出
- **自動vMix連携**: 最新のファイルを自動的にvMixに追加し、OA（Overlay 4）にスタンバイ
- **リサイズプリセット**: 6種類のリサイズプリセットをボタンで簡単に適用
- **設定保存**: ディレクトリパス、vMix接続情報、ウィンドウサイズなどを自動保存
- **モダンUI**: CustomTkinterを使用したダークモードの美しいインターフェース

## 必要要件

- Python 3.8以上
- vMix（実行中であること）

## インストール

1. リポジトリをクローンまたはダウンロード

2. 必要なパッケージをインストール:
```bash
pip install -r requirements.txt
```

## 使い方

1. アプリケーションを起動:
```bash
python main.py
```

2. **vMix接続設定**:
   - ホスト: vMixが動作しているPCのIPアドレス（同じPCの場合は `localhost`）
   - ポート: vMix Web APIのポート（デフォルト: `8088`）
   - 「接続テスト」ボタンで接続を確認

3. **ディレクトリ監視**:
   - 「参照」ボタンをクリックして監視するディレクトリを選択
   - 「監視開始」ボタンをクリックして監視を開始
   - ディレクトリ内の最新ファイルが自動的にvMixのOAにスタンバイされます

4. **リサイズプリセット**:
   - 6種類のプリセットボタンから選択してクリック
   - スタンバイ中の映像の位置とサイズが変更されます

## リサイズプリセット

デフォルトで以下の6種類のプリセットが用意されています：

1. **フルスクリーン** (1920x1080): 画面全体に表示
2. **左半分** (960x1080): 画面の左半分に表示
3. **右半分** (960x1080): 画面の右半分に表示
4. **右下1/4** (960x540): 画面の右下1/4に表示
5. **左下1/4** (960x540): 画面の左下1/4に表示
6. **中央1/2** (960x540): 画面中央に1/2サイズで表示

### プリセットの編集

プリセットボタンを**右クリック**すると編集ダイアログが開きます。以下のパラメータを調整できます：

- **プリセット名**: プリセットの名前
- **位置とサイズ**: X座標、Y座標、幅、高さ
- **Zoom**: ズーム倍率（0.1-5.0）
- **Pan**: 水平・垂直パン（-2.0 ~ 2.0）
- **Crop**: クロップ範囲（X1, Y1, X2, Y2: 0.0-1.0）

各パラメータはスライダーで直感的に調整できます。設定は自動的に `config.json` に保存されます。

## 設定ファイル

初回起動時に `config.json` が作成されます。以下の設定が保存されます：

```json
{
  "watch_directory": "C:/path/to/watch",
  "vmix_host": "localhost",
  "vmix_port": 8088,
  "auto_add_to_vmix": true,
  "window_geometry": "900x700",
  "presets": [
    {
      "name": "フルスクリーン",
      "x": 0,
      "y": 0,
      "width": 1920,
      "height": 1080,
      "zoom": 1.0,
      "panX": 0.0,
      "panY": 0.0,
      "cropX1": 0.0,
      "cropY1": 0.0,
      "cropX2": 1.0,
      "cropY2": 1.0
    }
  ]
}
```

## ファイル構成

```
vmix-controller/
├── main.py                 # メインアプリケーション
├── file_watcher.py         # ファイル監視モジュール
├── vmix_controller.py      # vMix制御モジュール
├── config_manager.py       # 設定管理モジュール
├── preset_editor.py        # プリセット編集ダイアログ
├── requirements.txt        # 必要パッケージリスト
├── config.json            # 設定ファイル（自動生成）
└── README.md              # このファイル
```

## トラブルシューティング

### vMixに接続できない

- vMixが起動しているか確認してください
- vMix設定で「Web Controller」が有効になっているか確認してください
- ファイアウォールがポート8088をブロックしていないか確認してください

### ファイルが検出されない

- ディレクトリパスが正しいか確認してください
- 監視が開始されているか確認してください（「監視停止」ボタンが表示されている状態）
- ディレクトリに対する読み取り権限があるか確認してください

### リサイズプリセットが動作しない

- スタンバイ中の入力があるか確認してください
- vMixとの接続が確立されているか確認してください

## ライセンス

MIT License

## 作者

Created with Claude Code
